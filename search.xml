<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[JSè¿›é˜¶â€”â€” bindå‡½æ•°]]></title>
    <url>%2Fweb%2FLP20190705A%2F</url>
    <content type="text"><![CDATA[â€œProgrammers are in a race with the Universe to create bigger and better idiot-proof programs, while the Universe is trying to create bigger and better idiots. So far the Universe is winning.â€ â€”Rich Cook å®˜æ–¹æè¿°é¦–å…ˆæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹MDNä¸Šå¯¹äºŽbindå‡½æ•°çš„å®šä¹‰ï¼Œä¸»è¦æœ‰ä¸‰ä¸ªç‰¹ç‚¹: bindå‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°ï¼ˆç§°ä¸ºç»‘å®šå‡½æ•°ï¼‰ï¼Œæ–°å‡½æ•°ä¸ŽåŽŸå‡½æ•°å…·æœ‰ç›¸åŒçš„å‡½æ•°ä½“ï¼ˆåœ¨ ECMAScript 5 è§„èŒƒä¸­å†…ç½®çš„callå±žæ€§ï¼‰ å½“ç”Ÿæˆçš„æ–°å‡½æ•°è¢«è°ƒç”¨æ‰§è¡Œæ—¶ï¼Œå…¶thiså€¼å§‹ç»ˆæŒ‡å‘bindå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸”æ— æ³•æ”¹å˜ binå‡½æ•°å¯ä»¥æŽ¥å—é¢„è®¾çš„å‚æ•°ï¼Œè¯¥å‚æ•°æœ€ç»ˆæä¾›ç»™åŽŸå‡½æ•° æ–°å‡½æ•°ä¹Ÿèƒ½ä½¿ç”¨newæ“ä½œç¬¦åˆ›å»ºå¯¹è±¡,è¿™ç§è¡Œä¸ºå°±åƒæŠŠåŽŸå‡½æ•°å½“æˆæž„é€ å™¨ã€‚æä¾›çš„ thiså€¼è¢«å¿½ç•¥ï¼ŒåŒæ—¶è°ƒç”¨æ—¶çš„å‚æ•°è¢«æä¾›ç»™æ¨¡æ‹Ÿå‡½æ•° ç”¨ä¾‹è¯´æ˜Žä¼—æ‰€å‘¨çŸ¥ï¼ŒJSä¸­å‡½æ•°(ES6ç®­å¤´å‡½æ•°é™¤å¤–)çš„thisæŒ‡å‘æ˜¯åœ¨å‡½æ•°æ‰§è¡Œæ—¶åŠ¨æ€ç»‘å®šçš„ï¼Œå‡½æ•°å®šä¹‰å’Œå®žé™…è¿è¡Œæ—¶çš„æ‰€å¤„çš„çŽ¯å¢ƒä¸ä¸€æ ·ï¼Œå¾€å¾€å¯¼è‡´æœªçŸ¥çš„bugã€‚ å°¤å…¶æ˜¯åœ¨Reactç»„ä»¶ä¸­ï¼Œç»å¸¸ä¼šç”±äºŽthisæŒ‡å‘é—®é¢˜å¯¼è‡´æ— æ³•è°ƒç”¨åˆ°å‡½æ•°ï¼Œæ‰€ä»¥é€šå¸¸æˆ‘ä»¬ä¼šåœ¨constructorå‡½æ•°ä¸­ä½¿ç”¨bindå‡½æ•°æ¥ç»‘å®šthis(å½“ç„¶ä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šä½¿ç”¨ç®­å¤´å‡½æ•°æ¥é¿å…æ­¤ç±»æƒ…å†µ)ã€‚ 123456789101112131415var name = "paopaolee"function test()&#123; console.log(this.name)&#125;var obj = &#123; name: "lepaopao", print: test,&#125;test(); // paopaoleeobj.print(); // lepaopaovar obj1 = &#123; name: 'xxxxxx', print: test.bind(this) // è¿”å›žäº†ä¸€ä¸ªæ–°å‡½æ•°å¹¶ä¸”thisæŒ‡å‘window&#125;obj1.print(); // paopaolee åŠ¨æ‰‹å®žçŽ°ç¬¬ä¸€ç‰ˆç›®æ ‡ï¼šå®žçŽ°æè¿°ä¸­çš„ç‰¹å¾1ã€2ã€3 åˆ†æžï¼šè¿”å›žçš„ç»“æžœæ˜¯ä¸€ä¸ªå‡½æ•°ï¼›æ–°å‡½æ•°è°ƒç”¨æ—¶thisæŒ‡å‘ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ å¯ä»¥é€šè¿‡call/applyå‡½æ•°è§£å†³ï¼Œcall/applyå‡½æ•°çš„åŒºåˆ«åœ¨äºŽå‚æ•°ä¼ é€’ï¼Œå‰è€…éœ€é€ä¸€åˆ—å‡ºï¼ŒåŽè€…å¯ä»¥ä¼ é€’æ•°ç»„ï¼›bindå‡½æ•°å¯æŽ¥å—é¢„è®¾å‚æ•°æœ€ç»ˆæä¾›åŽŸå‡½æ•°ï¼Œç”±äºŽå‚æ•°ä¸ç¡®å®šï¼Œæ‰€ä»¥é€‰ç”¨applyå®žçŽ°ã€‚ å®žçŽ°ï¼š 12345678Function.prototype.paopaoleeBind = function (Othat) &#123; var slice = Array.prototype.slice; var self = this; //æ™®é€šè°ƒç”¨æ—¶ï¼Œ thisæŒ‡å‘bindè°ƒç”¨è€… var args = slice(arguments, 1); return function () &#123; self.apply(Othat, args); &#125;&#125; ç¬¬äºŒç‰ˆé—®é¢˜ï¼šç¬¬ä¸€ç‰ˆä¸­åˆæ­¥å®žçŽ°äº†å‰ä¸‰ä¸ªç‰¹å¾ï¼Œå½“ç„¶è¿˜æœ‰è¯¸å¤šé—®é¢˜ï¼Œä¾‹å¦‚å¦‚æžœæ–°å‡½æ•°æ‰§è¡Œæ—¶éœ€è¦æœ‰è¿”å›žå€¼ã€ç¬¬ä¸€ç‰ˆä¸­å®žçŽ°äº†ç»‘å®šæ—¶ä¼ å‚ï¼Œé‚£æ–°å‡½æ•°è°ƒç”¨æ—¶ä¼ å‚æ•°å‘¢ï¼Ÿä»¥åŠbindå‡½æ•°è°ƒç”¨ä¸æ­£ç¡®ç­‰ç­‰ã€‚ ä¼˜åŒ–ï¼š 1234567891011121314Function.prototype.paopaoleeBind = function (Othat) &#123; var slice = Array.prototype.slice; var toString = Array.portotype.toString; var self = this; // è§£å†³: éžæ³•è°ƒç”¨ if(typeof self !=== 'function' || toString(self) !== [object Function])&#123; throw new TypeError("incorrectly call"); &#125; var args = slice(arguments, 1); return function () &#123; // è§£å†³: æ–°å‡½æ•°æ‰§è¡Œæ—¶returnè¿”å›žå€¼ return self.apply(Othat, args.concat(slice.call(arguments))); // è§£å†³: æ–°å‡½æ•°æ‰§è¡Œå¯æŽ¥å—å‚æ•° &#125;&#125; ç¬¬ä¸‰ç‰ˆç›®æ ‡ï¼š è§£å†³bindå‡½æ•°çš„ç¬¬ä¸‰ä¸ªç‰¹å¾: ä¸€ä¸ªç»‘å®šå‡½æ•°ä¹Ÿèƒ½ä½¿ç”¨newæ“ä½œç¬¦åˆ›å»ºå¯¹è±¡ï¼šè¿™ç§è¡Œä¸ºå°±åƒæŠŠåŽŸå‡½æ•°å½“æˆæž„é€ å™¨ã€‚æä¾›çš„ this å€¼è¢«å¿½ç•¥ï¼ŒåŒæ—¶è°ƒç”¨æ—¶çš„å‚æ•°è¢«æä¾›ç»™æ¨¡æ‹Ÿå‡½æ•°ã€‚ ä¹Ÿå°±æ˜¯è¯´bindæ‰§è¡Œè¿”å›žçš„æ–°å‡½æ•°ä½œä¸ºæž„é€ å‡½æ•°æ‰§è¡Œæ—¶ï¼Œbindæ—¶æŒ‡å®šçš„å¯¹è±¡(å‚æ•°Othat)ä¼šå¤±æ•ˆï¼Œä½†æ˜¯ä¼ å…¥çš„å‚æ•°ä¾ç„¶æœ‰æ•ˆã€‚ ä¸¾ä¸ªðŸŒ°ï¼š 123456789101112131415161718var vaule = 2var obj = &#123; value: 1&#125;function female(name, age)&#123; this.favorite = 'shopping'; console.log(this.value); console.log(name, age);&#125;female.prototype.husband = 'leepaopao';var boundFunc = female.bind(obj, 'paopaolee');var p = new bindedFunc(23);// undefined// paopaolee 23consple.log(p.habit); // shoppingconsple.log(p.husband); // leepaopao å°½ç®¡åœ¨windowä»¥åŠobjä¸­éƒ½å£°æ˜Žäº†valueå€¼ï¼Œä½†æœ€ç»ˆ(this.value)ä¾ç„¶è¿”å›žäº†undefinedï¼Œè¯´æ˜Žæ­¤æ—¶thiså³ä¸æŒ‡å‘windowä¹Ÿä¸æŒ‡å‘objï¼Œbindæ—¶ç»‘å®šçš„thisï¼ˆobjï¼‰å¤±æ•ˆäº†ã€‚æ‰€ä»¥æ­¤æ—¶thisçœŸæ­£æŒ‡å‘çš„æ˜¯femaleçš„å®žä¾‹ã€‚ åˆ†æžï¼š è¦åˆ¤æ–­æ–°å‡½æ•°è°ƒç”¨æ—¶æ˜¯å¦ä¸ºnewæž„é€ å‡½æ•°è°ƒç”¨ï¼Œå¯ä»¥é€šè¿‡thisæ˜¯å¦ä¸ºæ–°å‡½æ•°çš„å®žä¾‹,æ‰€ä»¥æˆ‘ä»¬æŠŠè¿”å›žçš„åŒ¿åå‡½æ•°æ¢æˆå…·åå‡½æ•°ï¼Œä»¥ä¾¿åˆ¤æ–­ã€‚ å®žçŽ° 1234567891011121314151617Function.prototype.paopaoleeBind = function (Othat) &#123; var slice = Array.prototype.slice; var toString = Array.portotype.toString; var self = this; // è§£å†³: éžæ³•è°ƒç”¨ if(typeof self !=== 'function' || toString(self) !== [object Function])&#123; throw new TypeError("incorrectly call"); &#125; var args = slice(arguments, 1); function boundFunc() &#123; // åˆ¤æ–­thisæ˜¯å¦ä¸ºboundFuncå®žä¾‹ï¼Œå¦‚æžœæ˜¯è¯´æ˜Žæ˜¯newæž„é€ å‡½æ•°è°ƒç”¨ï¼Œå¦åˆ™æ˜¯æ™®é€šè°ƒç”¨ var Othis = this instanceof boundFunc ? this : Othat; // è§£å†³: æ–°å‡½æ•°æ‰§è¡Œæ—¶returnè¿”å›žå€¼ return self.apply(Othis, args.concat(slice.call(arguments))); // è§£å†³: æ–°å‡½æ•°æ‰§è¡Œå¯æŽ¥å—å‚æ•° &#125; return boundFunc;&#125; ç¬¬äº”ç‰ˆé—®é¢˜ï¼š ç¬¬å››ç‰ˆä¸­ï¼Œæˆ‘ä»¬è§£å†³äº†ç‰¹å¾å››ï¼Œä½†æ˜¯ä½¿ç”¨newæ“ä½œç¬¦åˆ›å»ºå¯¹è±¡æ—¶ï¼ŒthisæŒ‡å‘çš„æ˜¯boundFuncçš„å®žä¾‹ï¼Œæ— æ³•ç»§æ‰¿åŽŸå‡½æ•°çš„åŽŸåž‹ä¸­çš„å±žæ€§ï¼ŒåŽŸåž‹é“¾é­åˆ°ç ´åã€‚ ç›®æ ‡ï¼šé‡å¡‘åŽŸåž‹é“¾ å®žçŽ°ï¼š 123456789101112131415161718Function.prototype.paopaoleeBind = function (Othat) &#123; var slice = Array.prototype.slice; var toString = Array.portotype.toString; var self = this; // è§£å†³: éžæ³•è°ƒç”¨ if(typeof self !=== 'function' || toString(self) !== [object Function])&#123; throw new TypeError("incorrectly call"); &#125; var args = slice(arguments, 1); function boundFunc() &#123; // åˆ¤æ–­thisæ˜¯å¦ä¸ºboundFuncå®žä¾‹ï¼Œå¦‚æžœæ˜¯è¯´æ˜Žæ˜¯newæž„é€ å‡½æ•°è°ƒç”¨ï¼Œå¦åˆ™æ˜¯æ™®é€šè°ƒç”¨ var Othis = this instanceof boundFunc ? this : Othat; // è§£å†³: æ–°å‡½æ•°æ‰§è¡Œæ—¶returnè¿”å›žå€¼ return self.apply(Othis, args.concat(slice.call(arguments))); // è§£å†³: æ–°å‡½æ•°æ‰§è¡Œå¯æŽ¥å—å‚æ•° &#125; boundFunc.prototype = this.portotype; return boundFunc;&#125; ä¸Šè¿°ä»£ç ï¼Œé‡å¡‘åŽŸåž‹é“¾çš„åšæ³•æ˜¯ç›´æŽ¥å°†boundFunc.prototype = this.prototypeï¼Œç›¸å½“äºŽç›´æŽ¥ç”¨åŽŸå‡½æ•°çš„prototypeè¦†ç›–æŽ‰äº†boundFuncå‡½æ•°åŽŸæ¥çš„prototypeï¼Œè¿™æ ·å¦‚æžœæˆ‘ä»¬æ›´æ”¹boundFunc.prototypeä¸­çš„å±žæ€§æ˜¯ä¹Ÿä¼šå½±å“åŽŸå‡½æ•°çš„prototypeä¸Šçš„å±žæ€§ã€‚ æœ€ç»ˆç‰ˆ12345678910111213141516171819202122232425Function.prototype.paopaoleeBind = function (Othat) &#123; var slice = Array.prototype.slice; var toString = Array.portotype.toString; var self = this; // è§£å†³: éžæ³•è°ƒç”¨ if(typeof self !=== 'function' || toString(self) !== [object Function])&#123; throw new TypeError("incorrectly call"); &#125; var args = slice(arguments, 1); function boundFunc() &#123; // åˆ¤æ–­thisæ˜¯å¦ä¸ºboundFuncå®žä¾‹ï¼Œå¦‚æžœæ˜¯è¯´æ˜Žæ˜¯newæž„é€ å‡½æ•°è°ƒç”¨ï¼Œå¦åˆ™æ˜¯æ™®é€šè°ƒç”¨ var Othis = this instanceof boundFunc ? this : Othat; // è§£å†³: æ–°å‡½æ•°æ‰§è¡Œæ—¶returnè¿”å›žå€¼ return self.apply(Othis, args.concat(slice.call(arguments))); // è§£å†³: æ–°å‡½æ•°æ‰§è¡Œå¯æŽ¥å—å‚æ•° &#125; // é‡å¡‘åŽŸåž‹é“¾: æ–¹æ³•ä¸€ boundFunc.prototype = Object.create(this.portotype); // é‡å¡‘åŽŸåž‹é“¾: æ–¹æ³•äºŒ /**** function fNOP ()&#123;&#125; fNOP.prototype = this.prototype; fbound.prototype = new fNOP(); ****/ return boundFunc;&#125;]]></content>
      <categories>
        <category>web</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
</search>
